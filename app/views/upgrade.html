
<div ng-repeat="upgrade in unit.upgrades.byClass.upgrade | filter:filterVisible">
  <div ng-if="upgrade.isCostMet()">
    <button class="btn pull-right"
      ng-class="{'btn-primary': upgrade.isCostMet(), 'btn-default': !upgrade.isCostMet()}"
      ng-click="buy({upgrade: upgrade})">
      <p>{{upgrade.type.label}}</p>
    </button>
  </div>
  <div ng-if="!upgrade.isCostMet()">
    <ul class="list-unstyled">
      <li>
        <div class="progress" style="margin-bottom:0">
          <div class="progress-bar" role="progressbar" aria-valuenow="{{upgrade.costMetPercent().times(1000)}}" aria-valuemin="0" aria-valuemax="1000" ng-style="{width:upgrade.costMetPercent().times(100)+'%'}">
            {{upgrade.costMetPercent()|percent:{floor:true} }} {{estimateUpgradeSecs(upgrade)|duration}}
          </div>
        </div>
        <div style="clear:right"></div>
      </li>
    </ul>
  </div>
  <span ng-repeat="cost in upgrade.totalCost() track by cost.unit.name">
    <unit-resource value="cost.val" unit="cost.unit"></unit-resource>
  </span>
</div>
